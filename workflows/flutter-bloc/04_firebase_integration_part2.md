---
description: Integrasi Firebase services untuk Flutter dengan **flutter_bloc** sebagai state management: Authentication, Cloud Fir... (Part 2/7)
---
# Workflow: Firebase Integration (flutter_bloc) (Part 2/7)

> **Navigation:** This workflow is split into 7 parts.

## Deliverables

### 1. Firebase Project Setup

**Description:** Setup Firebase project, konfigurasi Flutter app, dan inisialisasi di `bootstrap()` dengan `MultiBlocProvider`.

**Recommended Skills:** `senior-flutter-developer`, `senior-firebase-developer`

**Instructions:**
1. **Install FlutterFire CLI:**
   ```bash
   dart pub global activate flutterfire_cli
   ```

2. **Configure Firebase:**
   ```bash
   flutterfire configure
   ```

3. **Add Dependencies:** (Updated untuk Flutter 3.41.1)
   ```yaml
   dependencies:
     # Firebase
     firebase_core: ^3.12.0
     firebase_auth: ^5.5.0
     cloud_firestore: ^5.6.0
     firebase_storage: ^12.4.0
     firebase_messaging: ^15.2.0

     # BLoC
     flutter_bloc: ^9.1.0
     bloc: ^9.0.0
     equatable: ^2.0.7

     # DI
     get_it: ^8.0.3
     injectable: ^2.5.0

     # Utils
     dartz: ^0.10.1
     google_sign_in: ^6.2.2
     flutter_local_notifications: ^18.0.1
     flutter_image_compress: ^2.3.0
     path_provider: ^2.1.5

   dev_dependencies:
     injectable_generator: ^2.7.0
     build_runner: ^2.4.14
   ```

4. **Initialize Firebase di bootstrap:**

   Perbedaan kunci dari Riverpod: kita TIDAK pakai `ProviderScope`. Sebagai gantinya, semua Bloc/Cubit disediakan lewat `MultiBlocProvider` di root, dan service-service non-UI di-register ke `get_it`.

   ```dart
   // lib/bootstrap.dart
   import 'package:firebase_core/firebase_core.dart';
   import 'package:flutter/material.dart';
   import 'package:flutter_bloc/flutter_bloc.dart';
   import 'firebase_options.dart';
   import 'injection.dart';

   Future<void> bootstrap() async {
     WidgetsFlutterBinding.ensureInitialized();

     // 1. Init Firebase SEBELUM semua service lain
     await Firebase.initializeApp(
       options: DefaultFirebaseOptions.currentPlatform,
     );

     // 2. Init dependency injection (get_it + injectable)
     await configureDependencies();

     // 3. Init FCM service (harus setelah Firebase init)
     await getIt<NotificationService>().initialize();

     // 4. Run app dengan MultiBlocProvider
     runApp(const MyApp());
   }
   ```

5. **Root Widget dengan MultiBlocProvider:**
   ```dart
   // lib/app.dart
   class MyApp extends StatelessWidget {
     const MyApp({super.key});

     @override
     Widget build(BuildContext context) {
       return MultiBlocProvider(
         providers: [
           BlocProvider<AuthBloc>(
             create: (_) => getIt<AuthBloc>()..add(AuthCheckRequested()),
           ),
           // Bloc lain yang perlu global scope
         ],
         child: MaterialApp.router(
           routerConfig: getIt<AppRouter>().config,
           title: 'Firebase BLoC App',
         ),
       );
     }
   }
   ```

6. **DI Registration (injectable module):**
   ```dart
   // lib/injection.dart
   import 'package:get_it/get_it.dart';
   import 'package:injectable/injectable.dart';
   import 'injection.config.dart';

   final getIt = GetIt.instance;

   @InjectableInit()
   Future<void> configureDependencies() async => getIt.init();
   ```

   ```dart
   // lib/core/di/firebase_module.dart
   @module
   abstract class FirebaseModule {
     @lazySingleton
     FirebaseAuth get firebaseAuth => FirebaseAuth.instance;

     @lazySingleton
     FirebaseFirestore get firestore => FirebaseFirestore.instance;

     @lazySingleton
     FirebaseStorage get firebaseStorage => FirebaseStorage.instance;

     @lazySingleton
     FirebaseMessaging get firebaseMessaging => FirebaseMessaging.instance;
   }
   ```

**Output Format:**
```dart
// lib/firebase_options.dart (auto-generated by FlutterFire)
// File ini di-generate otomatis â€” JANGAN edit manual

import 'package:firebase_core/firebase_core.dart' show FirebaseOptions;
import 'package:flutter/foundation.dart'
    show defaultTargetPlatform, kIsWeb, TargetPlatform;

class DefaultFirebaseOptions {
  static FirebaseOptions get currentPlatform {
    if (kIsWeb) {
      return web;
    }
    switch (defaultTargetPlatform) {
      case TargetPlatform.android:
        return android;
      case TargetPlatform.iOS:
        return ios;
      case TargetPlatform.macOS:
        return macos;
      default:
        throw UnsupportedError('Unsupported platform');
    }
  }

  static const FirebaseOptions android = FirebaseOptions(
    apiKey: 'YOUR_API_KEY',
    appId: 'YOUR_APP_ID',
    messagingSenderId: 'YOUR_SENDER_ID',
    projectId: 'YOUR_PROJECT_ID',
    storageBucket: 'YOUR_BUCKET',
  );

  static const FirebaseOptions ios = FirebaseOptions(
    apiKey: 'YOUR_API_KEY',
    appId: 'YOUR_APP_ID',
    messagingSenderId: 'YOUR_SENDER_ID',
    projectId: 'YOUR_PROJECT_ID',
    storageBucket: 'YOUR_BUCKET',
    iosClientId: 'YOUR_IOS_CLIENT_ID',
    iosBundleId: 'YOUR_BUNDLE_ID',
  );
}
```

---

